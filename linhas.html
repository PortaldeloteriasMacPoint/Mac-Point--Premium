<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Análise de linhas,colunas,semi linhas e semi colunas</title>
  <style>
    body {
      margin: 0;
      font-family: Arial, sans-serif;
      background-color: #001a12;
      color: white;
    }
    .container {
      max-width: 1000px;
      margin: auto;
      padding: 20px;
    }
    select, button {
      margin: 5px 0;
      padding: 10px;
      width: 100%;
      font-size: 16px;
    }
    button {
      background: black;
      color: white;
      border: none;
      cursor: pointer;
    }
    .loader {
      display: none;
      text-align: center;
      margin-top: 20px;
    }
    .loader span {
      display: inline-block;
      width: 40px;
      height: 40px;
      border: 5px solid #00f;
      border-top: 5px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }
    @keyframes spin {
      0% { transform: rotate(0deg);}
      100% { transform: rotate(360deg);}
    }
    .relatorio {
      margin-top: 20px;
      background: #111;
      padding: 20px;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Análise de Concursos</h1>
    <select id="filtroQtd">
      <option value="10">Últimos 10 concursos</option>
      <option value="50">Últimos 50 concursos</option>
      <option value="100">Últimos 100 concursos</option>
    </select>
    <button onclick="gerarRelatorio()">Gerar Relatório</button>
    <div class="loader" id="loader">
      <span></span>
      <p>Aguarde só um instante, sua análise está sendo feita...</p>
    </div>
    <div class="relatorio" id="relatorio"></div>
  </div>

  <script>
    const linhas = {
      "1": [1,2,3,4,5,6,7,8,9,10],
      "2": [11,12,13,14,15,16,17,18,19,20],
      "3": [21,22,23,24,25,26,27,28,29,30],
      "4": [31,32,33,34,35,36,37,38,39,40],
      "5": [41,42,43,44,45,46,47,48,49,50],
      "6": [51,52,53,54,55,56,57,58,59,60]
    };
    const semilinhas = {
      "1": [1,2,3,4,5],
      "2": [6,7,8,9,10],
      "3": [11,12,13,14,15],
      "4": [16,17,18,19,20],
      "5": [21,22,23,24,25],
      "6": [26,27,28,29,30],
      "7": [31,32,33,34,35],
      "8": [36,37,38,39,40],
      "9": [41,42,43,44,45],
      "10": [46,47,48,49,50],
      "11": [51,52,53,54,55],
      "12": [56,57,58,59,60]
    };
    const colunas = {};
    for(let i=1; i<=10; i++){
      colunas[i] = [];
      for(let j=0; j<6; j++){
        let num = i + j*10;
        if(num <= 60) colunas[i].push(num);
      }
    }
    const semicolunas = {};
    for(let i=1; i<=10; i++){
      semicolunas[i] = [];
      for(let j=0; j<3; j++){
        let num = i + j*10;
        if(num <= 60) semicolunas[i].push(num);
      }
    }

    async function gerarRelatorio() {
      const qtd = document.getElementById("filtroQtd").value;
      const loader = document.getElementById("loader");
      const relatorio = document.getElementById("relatorio");
      loader.style.display = "block";
      relatorio.innerHTML = "";

      try {
        const response = await fetch("https://premium-portaldeloteriasmacpoint.onrender.com/api.php");
        const data = await response.json();

        const ultimos = data.slice(0, Number(qtd));
        let freq = {};
        for(let i=1; i<=60; i++) freq[i] = 0;

        ultimos.forEach(concurso => {
          concurso.numeros.forEach(n => freq[n]++);
        });

        function contar(setor) {
          let result = {};
          for (let s in setor) {
            result[s] = 0;
            setor[s].forEach(num => {
              result[s] += freq[num] || 0;
            });
          }
          return result;
        }

        const resultado = {
          linhas: contar(linhas),
          semilinhas: contar(semilinhas),
          colunas: contar(colunas),
          semicolunas: contar(semicolunas),
          mais_frequentes: Object.entries(freq).sort((a,b)=>b[1]-a[1]).slice(0,6),
          menos_frequentes: Object.entries(freq).sort((a,b)=>a[1]-b[1]).slice(0,6)
        };

        let html = "<h2>Relatório</h2>";

        html += "<h3>Frequência por Linha</h3><ul>";
        for (let l in resultado.linhas) {
          html += `<li>Linha ${l}: ${resultado.linhas[l]} ocorrência(s)</li>`;
        }
        html += "</ul><h3>Frequência por Coluna</h3><ul>";
        for (let c in resultado.colunas) {
          html += `<li>Coluna ${c}: ${resultado.colunas[c]} ocorrência(s)</li>`;
        }
        html += "</ul><h3>Frequência por Semilinha</h3><ul>";
        for (let sl in resultado.semilinhas) {
          html += `<li>Semilinha ${sl}: ${resultado.semilinhas[sl]} ocorrência(s)</li>`;
        }
        html += "</ul><h3>Frequência por Semicoluna</h3><ul>";
        for (let sc in resultado.semicolunas) {
          html += `<li>Semicoluna ${sc}: ${resultado.semicolunas[sc]} ocorrência(s)</li>`;
        }
        html += "</ul><h3>Mais Frequentes</h3><ul>";
        resultado.mais_frequentes.forEach(p => {
          html += `<li>${p[0]}: ${p[1]}x</li>`;
        });
        html += "</ul><h3>Menos Frequentes</h3><ul>";
        resultado.menos_frequentes.forEach(p => {
          html += `<li>${p[0]}: ${p[1]}x</li>`;
        });
        html += "</ul>";

        relatorio.innerHTML = html;
      } catch (e) {
        relatorio.innerHTML = "<p>Erro ao carregar dados.</p>";
      }
      loader.style.display = "none";
    }
  </script>
</body>
</html>


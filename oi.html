<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Relatório Mega-Sena</title>
  <style>
    body {
      margin: 0;
      background-color: #001a12;
      color: white;
      font-family: Arial, sans-serif;
    }

    header {
      background-color: #355E3B;
      padding: 15px;
      text-align: center;
      font-size: 2em;
      font-weight: bold;
    }

    .container {
      padding: 20px;
    }

    .painel {
      background: black;
      padding: 15px;
      border-radius: 10px;
      margin-bottom: 20px;
    }

    .painel label {
      display: block;
      margin-bottom: 5px;
    }

    .painel select {
      width: 100%;
      padding: 8px;
      margin-bottom: 15px;
      border-radius: 5px;
      border: none;
      background-color: #222;
      color: white;
    }

    .painel button {
      background-color: darkorange;
      color: black;
      font-weight: bold;
      padding: 10px 20px;
      border: 2px solid black;
      border-radius: 8px;
      text-shadow: 1px 1px 1px black;
      cursor: pointer;
      font-size: 16px;
    }

    .ranking {
      margin-bottom: 20px;
      background: #000;
      padding: 10px;
      border-radius: 8px;
    }

    .ranking h3 {
      margin: 0 0 10px 0;
      font-size: 1.1em;
      color: #fff;
    }

    .dezenas {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
    }

    .bola {
      width: 45px;
      height: 45px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 16px;
      text-shadow: 1px 1px 1px black;
      color: white;
    }

    @media (max-width: 600px) {
      .bola {
        width: 36px;
        height: 36px;
        font-size: 14px;
      }
    }
  </style>
</head>
<body>
  <header>Relatório Mega-Sena</header>
  <div class="container">
    <div class="painel">
      <label for="quantidade">Quantidade de concursos:</label>
      <select id="quantidade">
        <option value="10">10 últimos</option>
        <option value="20">20 últimos</option>
        <option value="30">30 últimos</option>
        <option value="50">50 últimos</option>
        <option value="100">100 últimos</option>
      </select>

      <label for="filtro">Tipo de análise:</label>
      <select id="filtro">
        <option value="frequencia">Frequência</option>
        <option value="atrasadas">Mais atrasadas</option>
        <option value="fortes">Mais fortes</option>
        <option value="ciclos">Ciclos</option>
        <option value="paresimpares">Ímpares/Pares</option>
        <option value="colunas">Colunas/Cores</option>
      </select>

      <button onclick="gerar()">Gerar Relatório</button>
    </div>

    <div id="resultados">Selecione os filtros acima e clique em "Gerar Relatório".</div>
  </div>

  <script>
    const cores = {
      1: "#FF0000", 2: "#FFFF00", 3: "#00FF00", 4: "#A52A2A", 5: "#0000FF", 6: "#FF69B4",
      7: "#000000", 8: "#808080", 9: "#FFA500", 10: "#FFFFFF"
    };

    function corDaDezena(dezena) {
      const num = parseInt(dezena);
      const coluna = Math.ceil(num / 6);
      return cores[coluna] || "#FFFFFF";
    }

    async function gerar() {
      const qtd = parseInt(document.getElementById('quantidade').value);
      const filtro = document.getElementById('filtro').value;
      const container = document.getElementById("resultados");
      container.innerHTML = "Carregando...";

      try {
        // Fazendo a requisição à API para buscar os concursos
        const response = await fetch("https://premium-portaldeloteriasmacpoint.onrender.com/api.php");
        const data = await response.json();

        // Pegando os últimos "qtd" concursos
        const ultimos = data.slice(-qtd).reverse();
        container.innerHTML = "";

        let filtroResultado = [];

        if (filtro === "frequencia") {
          let freq = {};
          ultimos.forEach(c => {
            c.dezenas.forEach(d => {
              freq[d] = (freq[d] || 0) + 1;
            });
          });

          filtroResultado = Object.entries(freq).sort((a, b) => b[1] - a[1]);
        }

        if (filtro === "atrasadas") {
          let atrasadas = {};
          ultimos.forEach(c => {
            c.dezenas.forEach(d => {
              if (!atrasadas[d]) {
                atrasadas[d] = 0;
              }
              atrasadas[d] += 1;
            });
          });

          filtroResultado = Object.entries(atrasadas).sort((a, b) => a[1] - b[1]);
        }

        if (filtro === "fortes") {
          let fortes = {};
          ultimos.forEach(c => {
            c.dezenas.forEach(d => {
              fortes[d] = (fortes[d] || 0) + 1;
            });
          });

          filtroResultado = Object.entries(fortes).sort((a, b) => b[1] - a[1]);
        }

        if (filtro === "ciclos") {
          let ciclos = {};
          ultimos.forEach(c => {
            c.dezenas.forEach(d => {
              if (!ciclos[d]) {
                ciclos[d] = 0;
              }
              ciclos[d] += 1;
            });
          });

          filtroResultado = Object.entries(ciclos).sort((a, b) => b[1] - a[1]);
        }

        if (filtro === "paresimpares") {
          let pares = 0, impares = 0;
          ultimos.forEach(c => {
            c.dezenas.forEach(d => {
              if (d % 2 === 0) {
                pares++;
              } else {
                impares++;
              }
            });
          });

          filtroResultado = [["Pares", pares], ["Ímpares", impares]];
        }

        if (filtro === "colunas") {
          let colunas = [0, 0, 0, 0, 0, 0];
          ultimos.forEach(c => {
            c.dezenas.forEach(d => {
              colunas[Math.floor((d - 1) / 6)]++;
            });
          });

          filtroResultado = colunas.map((count, index) => [`Coluna ${index + 1}`, count]);
        }

        const bloco = document.createElement("div");
        bloco.className = "ranking";
        const titulo = document.createElement("h3");
        titulo.textContent = filtro.charAt(0).toUpperCase() + filtro.slice(1);
        bloco.appendChild(titulo);

        const dezenas = document.createElement("div");
        dezenas.className = "dezenas";

        filtroResultado.forEach(([dz, count]) => {
          const bola = document.createElement("div");
          bola.className = "bola";
          bola.style.backgroundColor = corDaDezena(dz);
          bola.textContent = dz;
          dezenas.appendChild(bola);
        });

        bloco.appendChild(dezenas);
        container.appendChild(bloco);

      } catch (error) {
        container.innerHTML = "Erro ao carregar dados. Tente novamente.";
      }
    }
  </script>
</body>
</html>

